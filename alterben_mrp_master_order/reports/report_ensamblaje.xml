<odoo>
    <data>
        <record id="action_report_ensamblaje" model="ir.actions.report">
            <field name="name">Orden de Ensamblaje</field>
            <field name="model">mrp.master.order</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">alterben_mrp_master_order.report_ensamblaje</field>
            <field name="print_report_name">'Ensamblaje - ' + (doc.name or '')</field>
        </record>

        <template id="report_ensamblaje">
            <t t-call="web.basic_layout">
                <div class="page" style="margin-top:0; padding-top:0;">
                    <h2 style="text-align:center">ORDEN DE ENSAMBLADO</h2>
                    
                    <div>
                        <strong>FECHA DE IMPRESIÓN:</strong>
                        <span t-esc="now_str"/>
                        <span style="display:inline-block; margin-left:24px;">
                            <strong>RESPONSABLE:</strong> <span t-esc="username"/>
                        </span>
                    </div>
                    <div>
                        <strong>ORDEN MAESTRA:</strong> <span t-esc="master and (master.name or '') or ''"/>
                    </div>
                    <br/>
                    <table class="table table-sm o_main_table" style="width:100%; font-size:11px;">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Pedido de origen</th>
                                <th style="width:40%">Producto</th>
                                <th>Código</th>
                                <th style="text-align:right">Programado hoy</th>
                                <th style="text-align:right">Arrastre</th>
                                <th style="text-align:right">Cantidad total</th>
                                <th style="text-align:right">Cantidad producida</th>
                                <th style="text-align:right">Desechados</th>
                                <th>Observaciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-set="_i" t-value="0"/>
                            <tr t-foreach="lines" t-as="l">
                                <t t-set="_i" t-value="_i + 1"/>
                                <td t-esc="_i"/>
                                <td t-esc="l.pedido_original_id.name or ''"/>
                                <td t-esc="l.product_id.display_name"/>
                                <td t-esc="l.product_code or (l.product_id.default_code or '')"/>
                                <td style="text-align:right" t-esc="'%.2f' % (l.product_qty or 0.0)"/>
                                <td style="text-align:right" t-esc="'%.2f' % (l.arrastre_qty or 0.0)"/>
                                <td style="text-align:right" t-esc="'%.2f' % (l.qty_total or 0.0)"/>
                                <td style="text-align:right" t-esc="'%.2f' % (l.cantidad_real or 0.0)"/>
                                <td style="text-align:right" t-esc="'%.2f' % (l.scrap_qty or 0.0)"/>
                                <td t-esc="l.note or ''"/>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="4" style="text-align:right"><strong>TOTALES:</strong></td>
                                <td style="text-align:right"><span t-esc="'%.2f' % total_program"/></td>
                                <td style="text-align:right"><span t-esc="'%.2f' % total_arrastre"/></td>
                                <td style="text-align:right"><span t-esc="'%.2f' % total_qty"/></td>
                                <td style="text-align:right"><span t-esc="'%.2f' % total_produced"/></td>
                                <td style="text-align:right"><span t-esc="'%.2f' % total_scrap"/></td>
                                <td></td>
                            </tr>
                        </tfoot>
                    </table>
                    <br/>
                    <div>
                        <strong>NOTAS ADICIONALES:</strong>
                        <div t-esc="notes" style="min-height:40px; border:1px solid #ccc; padding:6px"/>
                    </div>
                </div>
            </t>
        </template>
    </data>
</odoo>
