<odoo>
    <data>
        <record id="action_report_inspeccion_final" model="ir.actions.report">
            <field name="name">Orden de Inspección Final</field>
            <field name="model">mrp.master.order</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">alterben_mrp_master_order.report_inspeccion_final</field>
            <field name="print_report_name">'Inspección Final - ' + (doc.name or '')</field>
        </record>

        <template id="report_inspeccion_final">
            <t t-call="web.basic_layout">
                <div class="page" style="margin-top:0; padding-top:0;">
                    <h2 style="text-align:center">ORDEN DE INSPECCIÓN FINAL</h2>
                    
                    <div>
                        <strong>FECHA DE IMPRESIÓN:</strong>
                        <span t-esc="now_str"/>
                        <span style="display:inline-block; margin-left:24px;">
                            <strong>RESPONSABLE:</strong> <span t-esc="username"/>
                        </span>
                    </div>
                    <div>
                        <strong>ORDEN MAESTRA:</strong> <span t-esc="master and (master.name or '') or ''"/>
                    </div>
                    <br/>
                    <table class="table table-sm o_main_table" style="width:100%; font-size:11px; table-layout:fixed; margin:0 auto;">
                        <thead>
                            <tr>
                                <th style="width:5%">#</th>
                                <th style="width:10%">C?digo</th>
                                <th style="width:32%">Producto</th>
                                <th style="width:8%; text-align:right">Reciclo</th>
                                <th style="width:8%; text-align:right">Almac?n</th>
                                <th style="width:8%; text-align:right">Segunda</th>
                                <th style="width:8%; text-align:right">Destruidos</th>
                                <th style="width:7%; text-align:center">Vitrificaci?n</th>
                                <th style="width:7%; text-align:right">Cantidad</th>
                                <th style="width:7%">Observaciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-set="_i" t-value="0"/>
                            <tr t-foreach="lines" t-as="l">
                                <t t-set="_i" t-value="_i + 1"/>
                                <td t-esc="_i"/>
                                <td t-esc="l.product_code or (l.product_id.default_code or '')"/>
                                <td t-esc="l.product_id.display_name"/>
                                <td style="text-align:right" t-esc="'%.0f' % (l.reciclo_qty or 0)"/>
                                <td style="text-align:right" t-esc="'%.0f' % (l.almacen_qty or 0)"/>
                                <td style="text-align:right" t-esc="'%.0f' % (l.segunda_qty or 0)"/>
                                <td style="text-align:right" t-esc="'%.0f' % (l.destruidos_qty or 0)"/>
                                <td style="text-align:center">
                                    <t t-if="l.vitrificacion_ok">X</t>
                                </td>
                                <td style="text-align:right" t-esc="'%.2f' % (l.product_qty or 0.0)"/>
                                <td t-esc="l.note or ''"/>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="3" style="text-align:right"><strong>TOTALES:</strong></td>
                                <td style="text-align:right"><span t-esc="'%.0f' % (total_reciclo or 0)"/></td>
                                <td style="text-align:right"><span t-esc="'%.0f' % (total_almacen or 0)"/></td>
                                <td style="text-align:right"><span t-esc="'%.0f' % (total_segunda or 0)"/></td>
                                <td style="text-align:right"><span t-esc="'%.0f' % (total_destruidos or 0)"/></td>
                                <td style="text-align:center"><span t-esc="total_vitrificacion or 0"/></td>
                                <td style="text-align:right"><span t-esc="'%.2f' % total_qty"/></td>
                                <td></td>
                            </tr>
                        </tfoot>
                    </table>
                    <br/>
                    <div>
                        <strong>NOTAS ADICIONALES:</strong>
                        <div t-esc="notes" style="min-height:40px; border:1px solid #ccc; padding:6px"/>
                    </div>
                </div>
            </t>
        </template>
    </data>
</odoo>
